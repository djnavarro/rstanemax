<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian Emax model fit with Stan — stan_emax • rstanemax</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Bayesian Emax model fit with Stan — stan_emax" />

<meta property="og:description" content="Run sigmoidal Emax model fit with formula notation" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstanemax</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/emaxmodel.html">Simple Emax model fit with Stan</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/yoshidk6/rstanemax">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian Emax model fit with Stan</h1>
    <small class="dont-index">Source: <a href='https://github.com/yoshidk6/rstanemax/blob/master/R/stan_emax.R'><code>R/stan_emax.R</code></a></small>
    <div class="hidden name"><code>stan_emax.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Run sigmoidal Emax model fit with formula notation</p>
    
    </div>

    <pre class="usage"><span class='fu'>stan_emax</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='kw'>gamma.fix</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>e0.fix</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>priors</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a symbolic description of variables for Emax model fit.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an optional data frame containing the variables in the model.</p></td>
    </tr>
    <tr>
      <th>gamma.fix</th>
      <td><p>a numeric or NULL to specify gamma (Hill coefficient) in the sigmoidal Emax model.
If NULL, gamma will be estimated from the data.
If numeric, gamma is fixed at the number provided.
Default = 1 (normal Emax model).</p></td>
    </tr>
    <tr>
      <th>e0.fix</th>
      <td><p>a numeric or NULL to specify E0 in the Emax model.
If NULL, E0 will be estimated from the data.
If numeric, E0 is fixed at the number provided.
Default = NULL (estimate from the data).</p></td>
    </tr>
    <tr>
      <th>priors</th>
      <td><p>a named list specifying priors of parameters (ec50, emax, e0, gamma, sigma).
Each list item should be length 2 numeric vector, one corresponding to mean and
another corresponding to standard deviation.
Currently only supports normal distribution for priors.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed to `rstan::sampling` (e.g. iter, chains).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class `stanemax`</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>exposure.response.sample</span>)
<span class='no'>fit1</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_emax</span>(<span class='no'>response</span> ~ <span class='no'>exposure</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>exposure.response.sample</span>,
                  <span class='co'># the next line is only to make the example go fast enough</span>
                  <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>12345</span>)</div><div class='output co'>#&gt; 
#&gt; SAMPLING FOR MODEL 'emax' NOW (CHAIN 1).
#&gt; Chain 1: 
#&gt; Chain 1: Gradient evaluation took 0.002 seconds
#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 20 seconds.
#&gt; Chain 1: Adjust your expectations accordingly!
#&gt; Chain 1: 
#&gt; Chain 1: 
#&gt; Chain 1: Iteration:   1 / 500 [  0%]  (Warmup)
#&gt; Chain 1: Iteration:  50 / 500 [ 10%]  (Warmup)
#&gt; Chain 1: Iteration: 100 / 500 [ 20%]  (Warmup)
#&gt; Chain 1: Iteration: 150 / 500 [ 30%]  (Warmup)
#&gt; Chain 1: Iteration: 200 / 500 [ 40%]  (Warmup)
#&gt; Chain 1: Iteration: 250 / 500 [ 50%]  (Warmup)
#&gt; Chain 1: Iteration: 251 / 500 [ 50%]  (Sampling)
#&gt; Chain 1: Iteration: 300 / 500 [ 60%]  (Sampling)
#&gt; Chain 1: Iteration: 350 / 500 [ 70%]  (Sampling)
#&gt; Chain 1: Iteration: 400 / 500 [ 80%]  (Sampling)
#&gt; Chain 1: Iteration: 450 / 500 [ 90%]  (Sampling)
#&gt; Chain 1: Iteration: 500 / 500 [100%]  (Sampling)
#&gt; Chain 1: 
#&gt; Chain 1:  Elapsed Time: 0.479 seconds (Warm-up)
#&gt; Chain 1:                0.176 seconds (Sampling)
#&gt; Chain 1:                0.655 seconds (Total)
#&gt; Chain 1: </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>fit1</span>)</div><div class='output co'>#&gt; Inference for Stan model: emax.
#&gt; 1 chains, each with iter=500; warmup=250; thin=1; 
#&gt; post-warmup draws per chain=250, total post-warmup draws=250.
#&gt; 
#&gt;         mean se_mean    sd  2.5%    25%    50%    75%  97.5% n_eff Rhat
#&gt; emax  107.33    0.32  4.65 98.67 103.91 106.99 110.80 116.55   212    1
#&gt; e0      6.23    0.27  3.71 -0.33   3.66   6.15   8.87  14.12   190    1
#&gt; ec50   98.72    1.56 20.47 67.31  83.27  95.45 111.43 144.57   172    1
#&gt; gamma   1.00     NaN  0.00  1.00   1.00   1.00   1.00   1.00   NaN  NaN
#&gt; sigma  19.99    0.09  1.32 17.64  19.12  19.91  20.78  23.15   204    1
#&gt; 
#&gt; Samples were drawn using NUTS(diag_e) at Tue May 28 22:02:22 2019.
#&gt; For each parameter, n_eff is a crude measure of effective sample size,
#&gt; and Rhat is the potential scale reduction factor on split chains (at 
#&gt; convergence, Rhat=1).</div><div class='input'>
<span class='co'># Set priors manually, also estimate gamma instead of the default of fix to 1</span>
<span class='no'>fit2</span> <span class='kw'>&lt;-</span> <span class='fu'>stan_emax</span>(<span class='no'>response</span> ~ <span class='no'>exposure</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>exposure.response.sample</span>, <span class='kw'>gamma.fix</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                  <span class='kw'>priors</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>ec50</span>  <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>100</span>, <span class='fl'>30</span>), <span class='kw'>emax</span>  <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>100</span>, <span class='fl'>30</span>), <span class='kw'>e0</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>10</span>, <span class='fl'>5</span>),
                                <span class='kw'>gamma</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>3</span>), <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>30</span>)),
                  <span class='co'># the next line is only to make the example go fast enough</span>
                  <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>12345</span>)</div><div class='output co'>#&gt; 
#&gt; SAMPLING FOR MODEL 'emax' NOW (CHAIN 1).
#&gt; Chain 1: 
#&gt; Chain 1: Gradient evaluation took 0 seconds
#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
#&gt; Chain 1: Adjust your expectations accordingly!
#&gt; Chain 1: 
#&gt; Chain 1: 
#&gt; Chain 1: Iteration:   1 / 500 [  0%]  (Warmup)
#&gt; Chain 1: Iteration:  50 / 500 [ 10%]  (Warmup)
#&gt; Chain 1: Iteration: 100 / 500 [ 20%]  (Warmup)
#&gt; Chain 1: Iteration: 150 / 500 [ 30%]  (Warmup)
#&gt; Chain 1: Iteration: 200 / 500 [ 40%]  (Warmup)
#&gt; Chain 1: Iteration: 250 / 500 [ 50%]  (Warmup)
#&gt; Chain 1: Iteration: 251 / 500 [ 50%]  (Sampling)
#&gt; Chain 1: Iteration: 300 / 500 [ 60%]  (Sampling)
#&gt; Chain 1: Iteration: 350 / 500 [ 70%]  (Sampling)
#&gt; Chain 1: Iteration: 400 / 500 [ 80%]  (Sampling)
#&gt; Chain 1: Iteration: 450 / 500 [ 90%]  (Sampling)
#&gt; Chain 1: Iteration: 500 / 500 [100%]  (Sampling)
#&gt; Chain 1: 
#&gt; Chain 1:  Elapsed Time: 0.44 seconds (Warm-up)
#&gt; Chain 1:                0.135 seconds (Sampling)
#&gt; Chain 1:                0.575 seconds (Total)
#&gt; Chain 1: </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>fit2</span>)</div><div class='output co'>#&gt; Inference for Stan model: emax.
#&gt; 1 chains, each with iter=500; warmup=250; thin=1; 
#&gt; post-warmup draws per chain=250, total post-warmup draws=250.
#&gt; 
#&gt;         mean se_mean    sd  2.5%   25%    50%    75%  97.5% n_eff Rhat
#&gt; emax  104.45    0.60  7.05 91.19 99.74 104.13 109.68 119.29   138 1.02
#&gt; e0      8.05    0.30  3.14  1.48  5.89   8.14  10.51  13.32   113 1.00
#&gt; ec50   99.25    1.33 16.78 71.46 86.49  97.63 109.85 134.01   160 1.00
#&gt; gamma   1.07    0.02  0.17  0.79  0.95   1.05   1.17   1.45   122 1.02
#&gt; sigma  20.08    0.09  1.35 17.65 19.16  20.05  20.87  22.65   207 1.00
#&gt; 
#&gt; Samples were drawn using NUTS(diag_e) at Tue May 28 22:02:25 2019.
#&gt; For each parameter, n_eff is a crude measure of effective sample size,
#&gt; and Rhat is the potential scale reduction factor on split chains (at 
#&gt; convergence, Rhat=1).</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Kenta Yoshida.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

